<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Install drush on drupal 8 site (using downgraded composer ver.1) | Simon's Blog</title><meta name=keywords content><meta name=description content="Intuition I was recently working on a client site, and I got to the issue where the site will show &ldquo;Page unavailable&rdquo; upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.
I ran composer require drush/drush which will install the most recent compatible drush on my current working directory, but then I got this error:
1 2 3 4 5 6 ."><meta name=author content="Suowei Hu"><link rel=canonical href=https://blog.simon-hu.org/posts/2023.11.10-install-drush-on-drupal-8-site-using-downgraded-composer-ver.1/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.89e7a3cfb9906f56d1ff70930818833a11ce408c7bcab0b72a35ffe53439a75c.css integrity="sha256-ieejz7mQb1bR/3CTCBiDOhHOQIx7yrC3KjX/5TQ5p1w=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.simon-hu.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.simon-hu.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.simon-hu.org/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.simon-hu.org/apple-touch-icon.png><link rel=mask-icon href=https://blog.simon-hu.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Install drush on drupal 8 site (using downgraded composer ver.1)"><meta property="og:description" content="Intuition I was recently working on a client site, and I got to the issue where the site will show &ldquo;Page unavailable&rdquo; upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.
I ran composer require drush/drush which will install the most recent compatible drush on my current working directory, but then I got this error:
1 2 3 4 5 6 ."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.simon-hu.org/posts/2023.11.10-install-drush-on-drupal-8-site-using-downgraded-composer-ver.1/"><meta property="og:image" content="https://blog.simon-hu.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="article:section" content="posts"><meta property="og:site_name" content="Simon's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.simon-hu.org/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Install drush on drupal 8 site (using downgraded composer ver.1)"><meta name=twitter:description content="Intuition I was recently working on a client site, and I got to the issue where the site will show &ldquo;Page unavailable&rdquo; upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.
I ran composer require drush/drush which will install the most recent compatible drush on my current working directory, but then I got this error:
1 2 3 4 5 6 ."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.simon-hu.org/posts/"},{"@type":"ListItem","position":2,"name":"Install drush on drupal 8 site (using downgraded composer ver.1)","item":"https://blog.simon-hu.org/posts/2023.11.10-install-drush-on-drupal-8-site-using-downgraded-composer-ver.1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Install drush on drupal 8 site (using downgraded composer ver.1)","name":"Install drush on drupal 8 site (using downgraded composer ver.1)","description":"Intuition I was recently working on a client site, and I got to the issue where the site will show \u0026ldquo;Page unavailable\u0026rdquo; upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.\nI ran composer require drush/drush which will install the most recent compatible drush on my current working directory, but then I got this error:\n1 2 3 4 5 6 .","keywords":[],"articleBody":"Intuition I was recently working on a client site, and I got to the issue where the site will show “Page unavailable” upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.\nI ran composer require drush/drush which will install the most recent compatible drush on my current working directory, but then I got this error:\n1 2 3 4 5 6 ... The \"composer/installers\" plugin was skipped because it requires a Plugin API version (\"^1.0\") that does not match your Composer installation (\"2.6.0\"). You may need to run composer update with the \"--no-plugins\" option. The \"drupal/core-composer-scaffold\" plugin was skipped because it requires a Plugin API version (\"^1.0.0\") that does not match your Composer installation (\"2.6.0\"). You may need to run composer update with the \"--no-plugins\" option. The \"drupal/core-project-message\" plugin was skipped because it requires a Plugin API version (\"^1.1\") that does not match your Composer installation (\"2.6.0\"). You may need to run composer update with the \"--no-plugins\" option. The \"drupal/core-vendor-hardening\" plugin was skipped because it requires a Plugin API version (\"^1.1\") that does not match your Composer installation (\"2.6.0\"). You may need to run composer update with the \"--no-plugins\" option. ... After some research, I found this issue could be potentially related to a version mis-match of the composer and the drupal 8 (reference: link), the composer in the project could be of version 1.XX, and the local instance is using version 2.XX …\nFailed Attempt I quickly went online and found this solution: link, that uses the following command to upgrade/downgrade composer:\n1 2 3 4 # Down-grade to composer 1 sudo composer self-update --1; sudo apt-mark hold sp-composer; # Up-grade to composer 2 sudo apt-mark unhold sp-composer; sudo composer self-update --2 But this one only updates the composer version globally, and it does not solve the issue of installing drush on the current working directory. (I am using MAMP as my web server, and as a result, I will need to update the version of the composer located at /Applications/MAMP/bin/php/composer)\nWorking Solution In order to upgrade the “correct” composer, I did the following:\nFirst, getting one composer 1.10 version phar file from this site: link. Place it on some location you can found, here I am putting it at my MAMP directory/Applications/MAMP/bin/php/composer.phar. (Note: in order to run this file, you will either need to use box command to compile it (box compile composer.php), or use php as the interpreter to run it (php composer.php), Since here we are only using it temporarily, we will use the shortcut of php: `php /Applications/MAMP/bin/php/composer.phar –version ) Second, I will need to find the correct compatible version of drush via the official website, for my instance drush/drush:10 Lastly, running the require command to install: php /Applications/MAMP/bin/php/composer.phar require drush/drush:10 (OPTIONAL) If the memory is not sufficient during the composer install/update you might see something ilke this: Fatal error: Allowed memory size of 1610612736 bytes exhausted . In order to change the memory limit you will need to add a parameter -d memory_limit=-1 , the command comes together looks like: php -d memory_limit=-1 /Applications/MAMP/bin/php/composer.phar require drush/drush:10 ","wordCount":"526","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","author":{"@type":"Person","name":"Suowei Hu"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.simon-hu.org/posts/2023.11.10-install-drush-on-drupal-8-site-using-downgraded-composer-ver.1/"},"publisher":{"@type":"Organization","name":"Simon's Blog","logo":{"@type":"ImageObject","url":"https://blog.simon-hu.org/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.simon-hu.org/ accesskey=h title="Simon's Blog (Alt + H)">Simon's Blog</a><div class=logo-switches></div></div><ul id=menu><li><a href=https://blog.simon-hu.org/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://blog.simon-hu.org/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.simon-hu.org/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Install drush on drupal 8 site (using downgraded composer ver.1)</h1><div class=post-meta>3 min&nbsp;·&nbsp;526 words&nbsp;·&nbsp;Suowei Hu&nbsp;|&nbsp;<a href=https://github.com/SuoweiHu/SuoweiHu.github.io/content/posts/2023.11.10%20Install%20drush%20on%20drupal%208%20site%20%28using%20downgraded%20composer%20ver.1%29.md rel="noopener noreferrer" target=_blank>Edit</a></div></header><div class=post-content><h2 id=intuition>Intuition<a hidden class=anchor aria-hidden=true href=#intuition>#</a></h2><p>I was recently working on a client site, and I got to the issue where the site will show &ldquo;Page unavailable&rdquo; upon login. And upon the suspicion of a mis-placed module or uncleared cache, I wanted to install drush to perform some drush commands.</p><p>I ran <code>composer require drush/drush</code> which will install the most recent compatible drush on my current working directory, but then I got this error:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>The &#34;composer/installers&#34;           plugin was skipped because it requires a Plugin API version (&#34;^1.0&#34;)    that does not match your Composer installation (&#34;2.6.0&#34;). You may need to run composer update with the &#34;--no-plugins&#34; option.
</span></span><span class=line><span class=cl>The &#34;drupal/core-composer-scaffold&#34; plugin was skipped because it requires a Plugin API version (&#34;^1.0.0&#34;)  that does not match your Composer installation (&#34;2.6.0&#34;). You may need to run composer update with the &#34;--no-plugins&#34; option.
</span></span><span class=line><span class=cl>The &#34;drupal/core-project-message&#34;   plugin was skipped because it requires a Plugin API version (&#34;^1.1&#34;)    that does not match your Composer installation (&#34;2.6.0&#34;). You may need to run composer update with the &#34;--no-plugins&#34; option.
</span></span><span class=line><span class=cl>The &#34;drupal/core-vendor-hardening&#34;  plugin was skipped because it requires a Plugin API version (&#34;^1.1&#34;)    that does not match your Composer installation (&#34;2.6.0&#34;). You may need to run composer update with the &#34;--no-plugins&#34; option.
</span></span><span class=line><span class=cl>...
</span></span></code></pre></td></tr></table></div></div><p>After some research, I found this issue could be potentially related to a version mis-match of the composer and the drupal 8 (reference: <a href=https://www.drupal.org/project/search_api_solr/issues/3213306>link</a>), the composer in the project could be of version 1.XX, and the local instance is using version 2.XX &mldr;</p><h2 id=failed-attempt>Failed Attempt<a hidden class=anchor aria-hidden=true href=#failed-attempt>#</a></h2><p>I quickly went online and found this solution: <a href=https://serverpilot.io/docs/how-to-downgrade-to-composer-version-1/>link</a>, that uses the following command to upgrade/downgrade composer:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=c1># Down-grade to composer 1</span>
</span></span><span class=line><span class=cl>sudo composer self-update --1<span class=p>;</span> sudo apt-mark hold sp-composer<span class=p>;</span>
</span></span><span class=line><span class=cl><span class=c1># Up-grade   to composer 2</span>
</span></span><span class=line><span class=cl>sudo apt-mark unhold sp-composer<span class=p>;</span> sudo composer self-update --2
</span></span></code></pre></td></tr></table></div></div><p>But this one only updates the composer version globally, and it does not solve the issue of installing drush on the current working directory. (I am using MAMP as my web server, and as a result, I will need to update the version of the composer located at <code>/Applications/MAMP/bin/php/composer</code>)</p><h2 id=working-solution>Working Solution<a hidden class=anchor aria-hidden=true href=#working-solution>#</a></h2><p>In order to upgrade the &ldquo;correct&rdquo; composer, I did the following:</p><ol><li>First, getting one composer 1.10 version phar file from this site: <a href=https://getcomposer.org/download/>link</a>. Place it on some location you can found, here I am putting it at my MAMP directory<code>/Applications/MAMP/bin/php/composer.phar</code>. (Note: in order to run this file, you will either need to use box command to compile it (<code>box compile composer.php</code>), or use php as the interpreter to run it (<code>php composer.php</code>), Since here we are only using it temporarily, we will use the shortcut of php: `php /Applications/MAMP/bin/php/composer.phar &ndash;version )</li><li>Second, I will need to find the correct compatible version of drush via the <a href=https://www.drush.org/12.x/install/>official website</a>, for my instance <code>drush/drush:10</code></li><li>Lastly, running the require command to install: <code>php /Applications/MAMP/bin/php/composer.phar require drush/drush:10</code></li><li>(OPTIONAL) If the memory is not sufficient during the <code>composer install/update</code> you might see something ilke this: <code>Fatal error: Allowed memory size of 1610612736 bytes exhausted</code> . In order to change the memory limit you will need to add a parameter <code>-d memory_limit=-1 </code>, the command comes together looks like: <code>php -d memory_limit=-1 /Applications/MAMP/bin/php/composer.phar require drush/drush:10</code></li></ol></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>&copy; 2023 <a href=https://blog.simon-hu.org/>Simon's Blog</a></span><br><span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>